# 2-3. 컴퓨터 성능 향상 기술

현대 컴퓨터의 가장 큰 문제점은 CPU와 메모리, 주변장치의 작업 속도가 다르다는 것이다.  
이번 절에서는 이러한 장치 간의 속도 차이를 개선하고 시스템의 작업 속도를 올리기 위해 개발된 기술 중 운영체제와 관련된 기술을 살펴본다.  

## 1.버퍼
### 버퍼
속도에 차이가 있는 두 장치 사이에서 그 차이를 완화하는 역할을 한다. 

### 스풀
CPU와 입출력장치가 독립적으로 동작하도록 고안된 소프트웨어적인 버퍼로 대표적인 예는 프린터에 사용되는 스풀러이다. 

## 2.캐시
### 캐시
캐시메모리와 CPU 간의 속도 차이를 완화하기 위해 메모리의 데이터를 미리 가져와 저장해두는 임시 장소이다. 

<img width="675" alt="Screen Shot 2022-08-21 at 7 16 47 PM" src="https://user-images.githubusercontent.com/77275707/185786355-0249c212-c398-4ea0-a761-375577bef71d.png">

### 즉시 쓰기와 지연 쓰기
즉시 쓰기는 캐시에 있는 데이터가 변경되면 이를 즉시 메모리에 반영하는 방식이다. 메모리와의 빈번한 데이터 전송으로 인해 성능이 느려진다는 것이 단점이지만, 
메모리의 최신 값이 항상 유지되기 때문에 급작스러운 정전에도 데이터를 잃어버리지 않는다.  
  
지연 쓰기는 캐시에 있는 데이터가 변경되면 이를 즉시 메모리에 반영하는 것이 아니라 변경된 내용을 모아서 주기적으로 반영하는 방식으로 카피백이라고도 한다.  
메모리와의 데이터 전송 횟수가 줄어들어 시스템의 성능을 향상할 수 있으나 메모리와 캐시된 데이터 사이의 불일치가 발생할 수 있다는 것이 단점이다. 
 
### L1 캐시와 L2 캐시
프로그램의 명령어는 크게 어떤 작업을 할지 나타내는 명령어 부분과 작업 대상인 데이터 부분으로 나눌 수 있다. 그리고 캐시는 명령어와 데이터의 구분 없이 모든 자료를 가져오는 일반 캐시, 
명령어와 데이터를 구분하여 가져오는 특수 캐시라는 두 가지 레벨로 구분된다. 
<img width="356" alt="Screen Shot 2022-08-21 at 7 20 34 PM" src="https://user-images.githubusercontent.com/77275707/185786502-fd0123d2-900b-45e0-b9cf-de02fd3d52e6.png">

## 3.저장장치의 계층 구조

<img width="521" alt="Screen Shot 2022-08-21 at 7 22 48 PM" src="https://user-images.githubusercontent.com/77275707/185786578-f8055478-1126-4136-85bb-d975496bd0dd.png">

## 4.인터럽트
### 인터럽트
초기 컴퓨터 시스템에는 주변장치가 많지 않아 CPU가 직접 입출력장치에서 데이터를 가져오거나 내보냈다. 이를 **폴링**방식이라고 한다.
폴링 방식에서는 CPU가 입출력장치의 상태를 주기적으로 검사하여 일정한 조건을 만족할 때 데이터를 처리한다. CPU가 명령어 해석과 실행이라는 본래 역할 외에 모든 입출력까지 관여해야 하므로
작업 효율이 떨어진다. 
이러한 문제를 해결하기 위해 등장한 것이 **인터럽트**방식이다. 
CPU의 작업과 데이터 이동을 독립적으로 운영함으로써 시스템의 효율을 높인다. 즉, 데이터의 입출력이 이루어지는 동안 CPU가 다른 작업을 할 수 있다. 

### 인터럽트 방식의 동작 과정

1.CPU가 입출력 관리자에게 입출력 명령을 보낸다.
2.입출력 관리자는 명령받은 데이터를 메모리에 가져다 놓거나 메모리에 있는 데이터를 저장장치로 옮긴다. 
3.데이터 전송이 완료되면 입출력 관리자는 완료 신호를 CPU에 보낸다. 

<img width="485" alt="Screen Shot 2022-08-21 at 7 31 30 PM" src="https://user-images.githubusercontent.com/77275707/185786832-a9e6adaf-b545-4fc4-9fc7-adb70577d9bb.png">

### 직접 메모리 접근
메모리는 CPU만 접근 권한을 가진 작업 공간이다. 입출력이 필요할 때 CPU는 입출력 관리자에게 입출력 요청을 보내고 하던 일을 계속한다. 
명령을 받은 입출력 관리자는 CPU가 요청한 데이터를 메모리에 가져다놓아야 하니 메모리에 접근 권한이 필요한데 이러한 권한을 직접 메모리 접근 이라고 한다. 
데이터 전송을 지시받은 입출력 관리자는 직접 메모리 접근 권한이 있어야 CPU의 관여 없이 작업을 완료할 수 있다. 
<img width="629" alt="Screen Shot 2022-08-21 at 7 32 27 PM" src="https://user-images.githubusercontent.com/77275707/185786871-2404212a-a4f9-4960-8cb9-c1a8b781eb11.png">

### 메모리 매핑 입출력
CPU가 사용하는 메모리 공간과 직접 메모리 접근 공간을 통해 들어오거나 나가는 데이터를 분리하여 할당하는 기법이다.   
<img width="206" alt="Screen Shot 2022-08-21 at 7 36 45 PM" src="https://user-images.githubusercontent.com/77275707/185787020-0fe6c995-564a-4c14-be17-ac1e3169af14.png">

### 사이클 훔치기
CPU와 직접 메모리 접근이 동시에 메모리에 접근하려 하는 경우 보통 CPU가 메모리 사용 권한을 양보한다. 
CPU의 작업 속도보다 입출력장치의 속도가 느리기 때문에 직접 메모리 접근에 양보하는데 이러한 상황을 사이클 훔치기 라고 한다.
